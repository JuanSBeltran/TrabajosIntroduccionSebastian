<!DOCTYPE html>
<html lang="es">

<head>
<meta charset="UTF-8" />
<link rel="stylesheet" href="/styles/index.css">
<link rel="icon" type="image/png" href="/assets/logo4.png">
<title>Open World</title>
</head>

<body>
<header class="header">
    <h1>Agencia de Viajes Open World</h1>
  </header>

  <nav class="nav">
    <ul>
      <li><a href="index.html">Inicio</a></li>
      <li><a href="inciar.html">Iniciar Sesi칩n</a></li>
      <li><a href="hoteles.html">Hoteles</a></li>
      <li><a href="#final">Contacto</a></li>
    </ul>
  </nav>

<!-- Carrusel -->
  <section class="slider">
    <div class="contenido">
      <img src="/assets/bogota.jpg" alt="">
      <img src="/assets/cali.jpg" alt="">
      <img src="/assets/cartagena.jpg" alt="">
      <img src="/assets/medellin.jpg" alt="">
       <img src="/assets/bo1.jpg" alt="">
      <img src="/assets/cali1.jpg" alt="">
      <img src="/assets/carta1.jpg" alt="">
      <img src="/assets/mede1.jpg" alt="">
      <img src="/assets/bog2.jpg" alt="">
      <img src="/assets/cali2.jpg" alt="">
      <img src="/assets/carta2.jpeg" alt="">
      <img src="/assets/mede2.jpg" alt="">
      <img src="/assets/bog3.jpg" alt="">
      <img src="/assets/cali3.jpg" alt="">
      <img src="/assets/carta3.jpg" alt="">
      

  </section>

<main id="inicio" class="main">
    <h2>Bienvenido</h2>
    <p>En Open World, te llevamos a descubrir los destinos m치s incre칤bles con los mejores paquetes al mejor precio.</p>
</main>



<!-- Destinos tur칤sticos -->
<section id="destinos" class="destinos-section">
    <h2>Destinos tur칤sticos de Colombia</h2>
    <div id="lista-destinos" class="destinos-container">
     <p class="loading">Cargando destinos...</p>
    </div>
</section>
<!-- Resultados de vuelos seleccionados -->
<section id="vuelos-resultados" style="margin-top: 40px;">
  <h2 style="text-align: center;">Vuelos disponibles</h2>
  <ul id="resultados-vuelos" class="destinos-container"></ul>
</section>


<footer id="final">
  <div class="footer-contenedor">
    
    <!-- Secci칩n de contacto -->
    <div class="footer-contacto">
      <h2 class="cc">Cont치ctanos</h2>
      <p class="wpp"><a href="https://wa.link/1iszww" target="_blank">WhatsApp</a></p>
      <p>Email: info@OpenWorld.com</p>
      <p>Direcci칩n: Calle 86 #69h-35</p>
    </div>

    <!-- Secci칩n de desarrolladores -->
    <div class="footer-devs">
      <h3>Desarrollado por:</h3>
      <ul>
        <li>Sebastian Crespo</li>
        <li>Anderson Alvarado</li>
        <li>Yenifer Rodriguez</li>
        <li>Brayan Valencia</li>
        <li>Cristina Medina</li>
        <li>Lizeth Rincon</li>
      </ul>
      <p class="dev-email">游닎 yenrosas982@gmail.Colombia</p>
    </div>

  </div>

  <p class="copy">&copy; 2025 Open World. Todos los derechos reservados.</p>
</footer>



<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const SUPABASE_URL = 'https://umoxzhitoujluggspitx.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVtb3h6aGl0b3VqbHVnZ3NwaXR4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExMTU2MTgsImV4cCI6MjA3NjY5MTYxOH0.7FahMznLDSsSaidDFUVpOc9Awy4iB5HQXxTkIL9RdN8';
const db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

const resultados = document.getElementById("resultados-vuelos");

/* ------------------ FUNCI칍N PARA MOSTRAR VUELOS (CORREGIDA) ------------------ */
async function mostrarVuelos(destinoId, destinoNombre) {
    resultados.innerHTML = `<li>Cargando vuelos a ${destinoNombre}...</li>`;

    const { data: vuelos, error } = await db
        .from('vuelos_disponibles')
        // MODIFICACI칍N CLAVE: Solicitamos 'hora_llegada'
        .select('id, origen_id, aerolinea, precio, duracion, fecha_salida, hora_salida, imagen_url, hora_llegada')
        .eq('destino_id', destinoId)
        .eq('disponible', true);

    if (error || !vuelos) {
        resultados.innerHTML = `<li style="color:red;">Error al buscar vuelos.</li>`;
        return;
    }

    if (vuelos.length === 0) {
        resultados.innerHTML = `<li>No hay vuelos disponibles hacia ${destinoNombre}.</li>`;
        return;
    }

    resultados.innerHTML = "";

    for (const vuelo of vuelos) {
        const { data: origenData } = await db
            .from('origen')
            .select('ciudad')
            .eq('id', vuelo.origen_id)
            .maybeSingle();

        vuelo.origen = origenData ? origenData.ciudad : "Desconocido";

        // NOTA: La tabla solo tiene la hora, asumimos que la llegada es el mismo d칤a que la salida.
        // Si el vuelo llega al d칤a siguiente, necesitar치s la 'fecha_llegada' en la base de datos.
        // Por ahora, solo mostramos la fecha de salida y la hora de llegada.
        
        const li = document.createElement("li");
        li.classList.add("vuelo-row-horizontal"); // CLASE MODIFICADA
        li.innerHTML = `
            <div class="vuelo-col aerolinea-info">
                <img src="${vuelo.imagen_url || 'assets/placeholder.jpg'}" alt="Logo Aerol칤nea" class="aerolinea-logo">
                <span class="aerolinea-nombre">${vuelo.aerolinea}</span>
            </div>

            <div class="vuelo-col ruta-info">
                <p><strong>De:</strong> ${vuelo.origen}</p>
                <p><strong>A:</strong> ${destinoNombre}</p>
                <p class="duracion">Duraci칩n: ${vuelo.duracion}</p>
            </div>

            <div class="vuelo-col horario-info">
                <p><strong>Salida:</strong> ${new Date(vuelo.fecha_salida).toLocaleDateString()} ${vuelo.hora_salida}</p>
                <p><strong>Llegada:</strong> ${vuelo.hora_llegada}</p>
            </div>

            <div class="vuelo-col precio-col">
                <span class="precio-final">COP $${vuelo.precio.toLocaleString('es-CO')}</span>
                <button class="btn-seleccionar">Seleccionar</button>
            </div>
        `;
        resultados.appendChild(li);
    }
}
/* ------------------ CARGAR DESTINOS Y HACERLOS CLICKEABLES ------------------ */
document.addEventListener("DOMContentLoaded", async () => {
  const contenedor = document.getElementById("lista-destinos");

  const { data, error } = await db.from('destinos').select('*');
  if (error || !data) {
    contenedor.innerHTML = `<p style="color:red;">Error al cargar los destinos.</p>`;
    return;
  }

  contenedor.innerHTML = "";

  data.forEach(destino => {
    const article = document.createElement("article");
    article.classList.add("destino-card");
    article.style.cursor = "pointer";

    article.innerHTML = `
      <img src="${destino.imagen_url || 'assets/placeholder.jpg'}" alt="${destino.ciudad}">
      <h3>${destino.ciudad}</h3>
      <p>${destino.descripcion}</p>
    `;

    article.addEventListener("click", () => {
      mostrarVuelos(destino.id, destino.ciudad);
      document.getElementById("vuelos-resultados").scrollIntoView({ behavior: "smooth" });
    });

    contenedor.appendChild(article);
  });
});
</script>


</body>
</html>


